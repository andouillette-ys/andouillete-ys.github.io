<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[Gandalf The Blue]]></title><description><![CDATA[Personal blog by shan yang.]]></description><link>https://gandalftheblue.github.io/gandalfTheBlue/</link><generator>RSS for Node</generator><lastBuildDate>Sat, 09 Mar 2019 15:05:40 GMT</lastBuildDate><item><title><![CDATA[React 项目在IE11下刷新页面出现404错误]]></title><link>https://gandalftheblue.github.io/gandalfTheBlue//refresh-react-project-in-IE11-404-error/</link><guid isPermaLink="false">https://gandalftheblue.github.io/gandalfTheBlue//refresh-react-project-in-IE11-404-error/</guid><content:encoded>&lt;p&gt;最近React项目遇到一个问题，当用户在IE11上刷新页面的时候会返回404错误页面。在其他浏览器上能够正常使用。
错误页面如下:&lt;/p&gt;
&lt;p&gt;
  &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;https://gandalftheblue.github.io/gandalfTheBlue//gandalfTheBlue/static/50a7cc7ecaad8e1f7506ed50ac639c5b/e7ea1/404-error.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
  
  &lt;span
    class=&quot;gatsby-resp-image-wrapper&quot;
    style=&quot;position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;&quot;
  &gt;
    &lt;span
      class=&quot;gatsby-resp-image-background-image&quot;
      style=&quot;padding-bottom: 38.14432989690722%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAAAsSAAALEgHS3X78AAABCElEQVQoz42RSW7DMAxFdf8z9AA9TrfdpF15jDU6tmTR+iFlF0WBpqmABxocP2n1ftEgIsSUK9uWkU5yJpRS/oU8ay3Uy+sb1phg3FJxYa1Yv2C+xZq87zvoARKTwTFGNE0LVXbCHAKMMYzGsiyscsOWUrUrJ0YemHN+iOTJlm3XQRHt1TGOV57QoG07DMOIruvZN/L3gJ4RFVL0GxKTJzVKbua9ZwICI80lQfzbecfD/qUw8+rlaCjHl3tdJ80rW0xsjxW/mz4jpUOE1HJDgg0RWjsY66HNYS0TI9+S4+kJkkNUMM83KMeqrOYfIgpP9DRBX6fql7gzX/YnEvfW8e17fFw+MfYD7tUabJ1Ns7rVAAAAAElFTkSuQmCC&apos;); background-size: cover; display: block;&quot;
    &gt;
      &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        style=&quot;width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;&quot;
        alt=&quot;IE 404 错误页面&quot;
        title=&quot;&quot;
        src=&quot;https://gandalftheblue.github.io/gandalfTheBlue//gandalfTheBlue/static/50a7cc7ecaad8e1f7506ed50ac639c5b/fb8a0/404-error.png&quot;
        srcset=&quot;/gandalfTheBlue/static/50a7cc7ecaad8e1f7506ed50ac639c5b/1a291/404-error.png 148w,
/gandalfTheBlue/static/50a7cc7ecaad8e1f7506ed50ac639c5b/2bc4a/404-error.png 295w,
/gandalfTheBlue/static/50a7cc7ecaad8e1f7506ed50ac639c5b/fb8a0/404-error.png 590w,
/gandalfTheBlue/static/50a7cc7ecaad8e1f7506ed50ac639c5b/e7ea1/404-error.png 776w&quot;
        sizes=&quot;(max-width: 590px) 100vw, 590px&quot;
      /&gt;
    &lt;/span&gt;
  &lt;/span&gt;
  
  &lt;/a&gt;
    &lt;/p&gt;
&lt;p&gt;项目背景：&lt;br/&gt;
1， 利用 create react app 构建&lt;br/&gt;
2， 部署在tomcat上&lt;br/&gt;
3， 采用 H5 History 路由&lt;br/&gt;&lt;/p&gt;
&lt;p&gt;服务端tomcat重定向的配置:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;xml&quot;&gt;&lt;pre class=&quot;language-xml&quot;&gt;&lt;code class=&quot;language-xml&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;error-page&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;error-code&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;404&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;error-code&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;location&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;/index.html&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;location&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;error-page&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;hr&gt;
&lt;p&gt;解决问题的思路很清晰，由于这个错误页面只在IE下面出现，只需要了解该页面出现的机制就行。经过简单的搜索，我发现这个页面是IE 的 &lt;a href=&quot;https://blogs.msdn.microsoft.com/ieinternals/2010/08/18/friendly-http-error-pages/&quot;&gt;Friendly HTTP Error Pages&lt;/a&gt;。&lt;br/&gt;&lt;/p&gt;
&lt;p&gt;自从IE5及以后的所有版本，如果服务端返回特定的错误码同时带的错误信息很短的话，IE会对用户显示上面那个更友好的错误页面。
而对于触发这个友好错误页面的条件有两个, 并且两个条件必须同时满足:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;服务端返回的 HTTP 状态码必须是 [400, 403, 404, 405, 406, 408, 409, 410, 500, 501, 505]&lt;/li&gt;
&lt;li&gt;HTTP 的消息体 (Response body) 的字节长度必须小于一个阙值&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;对于状态码 [403,405,410]，默认阈值是256字节，对于响状态码 [400,404,406,408,409,500,501,505]，默认阈值是512字节。&lt;/p&gt;
&lt;p&gt;经过检查，我们项目的index.html的大小果然是小于512字节，当tomcat把404重定向到index.html的时候触发了IE的友好错误页面显示。&lt;/p&gt;
                &lt;div style=&quot;margin-top=55px; font-style: italic;&quot;&gt;(This is an article posted to my blog at overreacted.io. You can read it online by &lt;a href=&quot;https://gandalftheblue.github.io/gandalfTheBlue//refresh-react-project-in-IE11-404-error/&quot;&gt;clicking here&lt;/a&gt;.)&lt;/div&gt;
              </content:encoded></item></channel></rss>